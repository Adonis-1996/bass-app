<div
  layout="column"
  class="main-page"
  ng-controller="AppController"
  ng-init="ui.instrumentIndex=0">

  <ng-include src="'views/main_toolbar.html'"></ng-include>

  <div flex style="max-height: 50px;"></div>

  <div
    class="bar-container"
    ng-controller="BarController"
    msd-wheel="
      slides.beatsPerView=slides.beatsPerView+$delta;
      updateSwipers()
    ">
    <div
      class="bar-preferences"
      ng-include src="'views/bars_form.html'">
    </div>
    <div class="bar-swiper">
      <ks-swiper-container
        id="barSwiper"
        swiper="swiper"
        on-ready="onBarSwiper(swiper)"
        initial-slide="0"
        loop="false"
        show-nav-buttons="true"
        slides-per-view="slides.beatsPerView"
        space-between="0"
        pagination-clickable="true"
        override-parameters="{
          slidesPerGroup: slides.beatsPerSlide,
          roundLengths: true
        }">

        <ks-swiper-slide
          ng-repeat="beat in slides.bars track by beat.id"
          class="bar-slide beat-{{ ::beat.beat }}">
          <label class="bar-label">
            {{ beat.bar }}
          </label>
          <div
            xng-init="renderingBar($index)"
            style="height:100%;"
            class="bar-beat"
            layout="row"
            ng-include src="'views/bar_slide.html'">
          </div>
        </ks-swiper-slide>
      </ks-swiper-container>
    </div>
  </div>

  <md-tabs
    md-no-ink
    md-no-pagination
    class="instruments-tabs"
    md-selected="ui.instrumentIndex">
    <md-tab label="bass">
  <div
    class="bass-board-container"
    ng-controller="NoteController">
    <md-button
      aria-label="Tunning"
      class="bass-tunning-button">
      <p ng-repeat="string in bass.strings | orderBy:string.index:'-'">
        {{ string.label }}<sub class="octave-index">{{ string.octave }}</sub><br>
      </p>
    </md-button>

    <div
      class="drop-note-area"
      ng-style="{
        width: dropNote.width+'px',
        left: dropNote.left===3? '-5000px' : dropNote.left+'px',
        top: dropNote.top+'px',
        opacity: dropNote.visible? 1 : 0
      }">
      <label>{{ dropNote.resizeNoteLength }}</label>
    </div>

    <div
      ng-include src="'views/bass_sound_form.html'">
    </div>
    <ks-swiper-container
      swiper="swiper"
      on-ready="onBassSwiper(swiper)"
      initial-slide="0"
      loop="false"

      show-nav-buttons="false"
      slides-per-view="slides.beatsPerView"
      space-between="0"
      override-parameters="{
        slidesPerGroup: slides.beatsPerSlide,
        roundLengths: true
      }">

      <ks-swiper-slide
        ng-repeat="beat in slides.bass track by beat.id"
        class="swiper-no-swiping bass-slide beat-{{ ::beat.beat }}"
        style="z-index: {{ ::100-$index}};">
        <div class="audio-graph-container">
          <canvas
            id="canvas_{{ ::beat.bar }}_{{ ::beat.beat }}"
            class="audio-graph">
          </canvas>
        </div>
        <div
          ng-init="renderingBar($index)"
          ng-include src="'views/bass_board_slide.html'">
        </div>
      </ks-swiper-slide>
    </ks-swiper-container>
  </div>

  <div
    style="margin-bottom: 20px;"
    ng-include src="'views/fretboard.html'">
  </div>
  </md-tab>
    <md-tab
      label="drums">
      <div
        class="drums-container"
        ng-controller="DrumsController">
        <div
          layout="column"
          class="drums-labels-container">
          <md-button
            ng-repeat="drum in ::drums track by drum.name"
            class="drum-label"
            aria-label="{{ ::drum.label }}"
            ng-click="playDrumSound(drum)">
            {{ ::drum.label }}
          </md-button>
        </div>
        <ks-swiper-container
          swiper="swiper"
          on-ready="onDrumsSwiper(swiper)"
          initial-slide="0"
          loop="false"

          show-nav-buttons="false"
          slides-per-view="slides.beatsPerView"
          space-between="0"
          override-parameters="{
            slidesPerGroup: slides.beatsPerSlide,
            roundLengths: true
          }">

          <ks-swiper-slide
            ng-repeat="beat in slides.drums track by beat.id"
            class="swiper-no-swiping drums-slide beat-{{ ::beat.beat }}">
            <div
              ng-include src="'views/drums_board_slide.html'">
            </div>
          </ks-swiper-slide>
        </ks-swiper-container>
      </div>
    </md-tab>
  </md-tabs>

  <div id="time-marker" class="time-marker"></div>

  <div flex></div>
</div>