<div
  layout="column"
  class="main-page"
  ng-controller="AppController"
  ng-init="ui.instrumentIndex=0">

  <ng-include src="'views/main_toolbar.html'"></ng-include>

  <div flex style="max-height: 50px;"></div>

  <div
    class="bar-container"
    ng-controller="BarController"
    msd-wheel="
      slides.beatsPerView=slides.beatsPerView+$delta;
      updateSwipers();
      $event.preventDefault()
    ">
    <div
      class="bar-preferences"
      ng-include src="'views/bars_form.html'">
    </div>
    <div
      class="context-menu"
      ng-include src="'views/bar_context_menu.html'">
    </div>
    <div class="bar-swiper">
      <ks-swiper-container
        id="barSwiper"
        class="bar-swiper"
        swiper="swiper"
        on-ready="onBarSwiper(swiper)"
        initial-slide="0"
        loop="false"
        show-nav-buttons="true"
        slides-per-view="slides.beatsPerView"
        space-between="0"
        pagination-is-active="true"
        pagination-clickable="true"
        override-parameters="{
          slidesPerGroup: slides.beatsPerSlide,
          roundLengths: true
        }">

        <ks-swiper-slide
          ng-repeat="beat in slides.bars track by beat.id"
          class="bar-slide beat beat-{{ ::beat.beat }}">
            <label class="bar-label">
              {{ beat.bar }}
            </label>
            <div
              xng-init="renderingBar($index)"
              class="bar-beat"
              layout="row"
              ng-right-click="contextMenu.open($event, $index)"
              ng-include src="'views/bar_slide.html'">
            </div>
        </ks-swiper-slide>
      </ks-swiper-container>
    </div>
  </div>

  <div
    flex
    class="instruments-tabs">
    <div
      ng-show="ui.instrumentIndex === 0"
      class="instrument-tab bass-board-container"
      ng-class="[bass.settings.label, 'strings-'+bass.strings.length]"
      ng-controller="BassController"
      ng-keyup="keyPressed($event)"
      ng-click="clearSelection($event)"
      layout="column">

      <div
        class="drop-note-area"
        ng-style="{
          width: dropNote.width+'px',
          left: dropNote.left+'px',
          top: dropNote.top+'px',
          opacity: dropNote.visible? 1 : 0
        }">
        <label>{{ dropNote.resizeNoteLength }}</label>
      </div>

      <md-button
        class="audio-graph-toggle no-hover"
        ng-class="{enabled: player.graphEnabled}"
        ng-click="player.graphEnabled = !player.graphEnabled">
        <md-icon md-svg-icon="audio-signal"></md-icon>
        <md-tooltip md-delay="1000" md-direction="right">Toggle bass audio graph</md-tooltip>
      </md-button>

      <div
        ng-include src="'views/bass_sound_form.html'">
      </div>

      <div style="position:relative;" flex="none">
        <div
          class="bass-preferences"
          ng-include src="'views/bass_board_form.html'">
        </div>
        <ks-swiper-container
          swiper="swiper"
          on-ready="onBassSwiper(swiper)"
          initial-slide="0"
          loop="false"

          show-nav-buttons="false"
          slides-per-view="slides.beatsPerView"
          space-between="0"
          override-parameters="{
            slidesPerGroup: slides.beatsPerSlide,
            roundLengths: true
          }"
          class="bass-swiper"
          ng-class="{'graph-enabled': player.graphEnabled}">

          <ks-swiper-slide
            ng-repeat="beat in slides.bass track by beat.id"
            class="swiper-no-swiping bass-slide beat-{{ ::beat.beat }}">
            <div class="audio-graph-container">
              <canvas
                id="canvas_{{ $index }}"
                class="audio-graph">
              </canvas>
            </div>
            <div
              xng-init="renderingBar($index)"
              class="bass-board"
              ng-include src="'views/bass_board_slide.html'">
            </div>
            <!-- <div>Bass slide {{::beat.beat}}</div> -->
          </ks-swiper-slide>
        </ks-swiper-container>
      </div>
      <div flex style="max-height: 40px;"></div>
      <div
        style="margin-bottom: 20px;"
        ng-include src="'views/fretboard.html'">
      </div>
      <span flex></span>
    </div>

    <div
      ng-show="ui.instrumentIndex === 1"
      class="instrument-tab drums-container"
      ng-controller="DrumsController">
      <div
        layout="column"
        class="drums-labels-container">
        <md-button
          ng-repeat="drum in ::drums track by drum.name"
          class="drum-label"
          aria-label="{{ ::drum.label }}"
          ng-click="playDrumSound(drum)">
          {{ ::drum.label }}
        </md-button>
      </div>
      <ks-swiper-container
        swiper="swiper"
        on-ready="onDrumsSwiper(swiper)"
        initial-slide="0"
        loop="false"

        show-nav-buttons="false"
        slides-per-view="slides.beatsPerView"
        space-between="0"
        override-parameters="{
          slidesPerGroup: slides.beatsPerSlide,
          roundLengths: true
        }"
        class="drums-swiper">

        <ks-swiper-slide
          ng-repeat="beat in slides.drums track by beat.id"
          class="swiper-no-swiping drums-slide beat-{{ ::beat.beat }}">
          <div
            ng-include src="'views/drums_board_slide.html'">
          </div>
        </ks-swiper-slide>
      </ks-swiper-container>
    </div>

  </div>

  <div
    id="time-marker"
    class="time-marker"
    style="visibility:hidden;">
  </div>

  <!-- <div flex></div> -->
</div>