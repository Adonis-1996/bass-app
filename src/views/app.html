<div
  layout="column"
  class="main-page"
  ng-controller="AppController">
  <!-- <div flex></div> -->
  <div
    layout="row"
    class="control-panel">

    <div
      layout="row"
      class="instruments-field">
      <md-button
        flex
        md-no-ink
        class="no-hover"
        ng-class="{
          active: instrumentIndex===0
        }"
        ng-click="instrumentIndex=0">
        Bass
        <md-icon md-svg-icon="bass-guitar"></md-icon>
      </md-button>
      <md-button
        flex
        md-no-ink
        class="no-hover"
        ng-class="{
          active: instrumentIndex===1
        }"
        ng-click="instrumentIndex=1">
        Drums
        <md-icon md-svg-icon="drums"></md-icon>
      </md-button>
      <md-ink-bar
        ng-class="{
          'md-left': instrumentIndex === 0,
          'md-right': instrumentIndex === 1
        }">
      </md-ink-bar>
    </div>

    <md-menu
      md-offset="56 10">
      <md-button
        class="instruments-prefferences"
        ng-click="$mdOpenMenu($event)">
        <md-icon
          md-svg-icon="preferences">
        </md-icon>
      </md-button>

      <md-menu-content
        width="4"
        class="instruments-prefferences md-whiteframe-16dp">
        <md-list>
          <md-list-item
            class="bass volume-field">
            <label>Bass Volume</label>
            <md-slider
              class="md-primary"
              ng-model="player.bass.audio.gain.value"
              ng-disabled="player.bass.muted"
              aria-label="Volume"
              min="0"
              max="1"
              step="0.01"
              flex>
            </md-slider>
            <md-button
              md-no-ink
              class="mute-button"
              ng-class="{active: !player.bass.muted}"
              md-prevent-menu-close
              ng-click="toggleVolumeMute(player.bass)">
              <md-icon
                md-svg-icon="{{ player.bass.muted? 'volume-mute' : 'volume-medium' }}">
              </md-icon>
            </md-button>
          </md-list-item>

          <md-list-item
            class="bass volume-field">
            <label>Drums Volume</label>
            <md-slider
              class="md-primary"
              ng-model="player.drums.audio.gain.value"
              ng-disabled="player.drums.muted"
              aria-label="Volume"
              min="0"
              max="1"
              step="0.01"
              flex>
            </md-slider>
            <md-button
              md-no-ink
              class="mute-button"
              ng-class="{active: !player.drums.muted}"
              md-prevent-menu-close
              ng-click="toggleVolumeMute(player.drums)">
              <md-icon
                md-svg-icon="{{ player.drums.muted? 'volume-mute' : 'volume-medium' }}">
              </md-icon>
            </md-button>
          </md-list-item>
        </md-list>

      </md-menu-content>
    </md-menu>

    <div flex></div>

    <div
      class="bpm-field">
      <md-input-container>
        <label>bpm</label>
        <input
          type="number"
          min="30"
          max="160"
          step="5"
          ng-model="player.bpm">
      </md-input-container>
    </div>

    <md-button
      class="play-stop-button"
      ng-click="player.playing? stop() : play()">
      <md-icon
        md-svg-icon="{{ player.playing? 'stop' : 'play' }}">
      </md-icon>
      {{ player.playing? 'Stop' : 'Play' }}
    </md-button>

    <div flex></div>

    <div
      layout="row"
      class="present-field">
      <md-input-container>
        <label>Bar</label>
        <input
          type="text"
          ng-model="bass.present.name">
      </md-input-container>
      <md-input-container>
        <md-select
          ng-show="bass.presents.length > 1"
          aria-label="Bar Present"
          class="select-editable"
          ng-model="bass.$selectedPresent"
          md-on-close="loadBassPresent(bass.$selectedPresent)">
          <md-option
            ng-repeat="present in bass.presents"
            ng-value="present">
            {{ present.name }}
          </md-option>
        </md-select>
      </md-input-container>
      <md-button
        aria-label="Save"
        class="toolbar-button"
        ng-click="saveBar()">
        <md-icon
          md-svg-icon="pen">
        </md-icon>
      </md-button>
      <md-menu md-position-mode="target-right target">
        <md-button
          aria-label="Menu"
          class="toolbar-button"
          ng-click="$mdOpenMenu($event)">
          <md-icon
            md-svg-icon="menu-dots">
          </md-icon>
        </md-button>
        <md-menu-content>
          <md-menu-item>
            <md-button
              ng-click="newBar()">
              New
            </md-button>
          </md-menu-item>
          <md-menu-item>
            <md-button
              ng-click="deleteBar(bass.$selectedPresent)">
              Delete
            </md-button>
          </md-menu-item>
        </md-menu-content>
      </md-menu>
    </div>
  </div>
  <div
    flex="none"
    class="bar-container">
    <ng-include
      src="'views/bar.html'">
    </ng-include>
    <div id="time-marker" class="time-marker"></div>
  </div>

  <md-tabs
    md-no-ink
    layout-fill
    class="instruments-tabs"
    md-selected="instrumentIndex"
    ng-init="instrumentIndex=1">
    <md-tab label="bass">
      <div class="audio-graph-container">
        <canvas
          id="canvas"
          class="audio-graph">
        </canvas>
      </div>

      <div
        ng-controller="NoteController"
        ng-include src="'views/bass_board.html'">
      </div>

      <div
        style="margin-bottom: 20px;"
        ng-include src="'views/fretboard.html'">
      </div>
    </md-tab>

    <md-tab label="drums">
      <div
        ng-include src="'views/drums_board.html'">
      </div>
    </md-tab>
  </md-tabs>

  <div flex></div>
</div>